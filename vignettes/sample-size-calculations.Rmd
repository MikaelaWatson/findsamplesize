---
title: "Sample Size Calculations"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Sample Size Calculations}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r setup}
library(findsamplesize)
```

<!-- This vignette is generated by fusen: do not edit by hand -->

<!--
 You need to run the 'description' chunk in the '0-dev_history.Rmd' file before continuing your code there.
-->


### Sample size calculation  

Calculates the  sample size to estimate the accuracy of a single diagnostic test, and generates a power table based on Zhou et al.
Calculates sample size in terms of true positives/ true negatives based on the parameters entered.
When prevalence and prevalence power are not entered the function gives the number of true positives/negatives. When they are entered, it gives the total number of subjects to be screened.


```{r examples-sample_size_calculation}
 sample_size_calculation(sen_spe= 0.8, alpha=0.05, power=0.8, margin=0.05, prevalence = NULL, prevalence_power = NULL, performance_characteristic = "sen") 
# Number of true positives for a sensitivity of 80%

 sample_size_calculation(sen_spe= 0.8, alpha=0.05, power=0.8, margin=0.05, prevalence = 0.1, prevalence_power = 0.9, performance_characteristic = "sen") 
 # Total  number of patients to be screened to test 80% sensitivity with 10% prevalence and 80% prevalence power


```

### Total N Calculation: 

 Calculates the total number of subjects to be screened to estimate the accuracy of a single diagnostic test, based on a known number of true positives/negatives that is needed, an estimate of prevalence , and prevalence power.


```{r examples-n_tot_calculation}

 n_tot_calculation(sample_size=503, prevalence = 0.1, prevalence_power = 0.9) 
# Total  number of patients to be screened to test 80% sensitivity with 10% prevalence and 80% prevalence power. 
# Should give the same number as the second example of sample_size_calculation

```

### Error margin Calculation  

Calculates the margin of error for one side based on the significance, power, sensitivity/specificity, and the number true positives/negatives, to estimate the accuracy of a single diagnostic test.




```{r examples-margin_calc}

 margin_calc(alpha=0.05, power=0.8, sen_spe=0.8, sample_size=502) 
# Error margin on one side. Using the same parameters as sample_size_calculation. Should be ~0.05

```

### Calculate Power  

Calculate the power of the design based on sample size, error margin, sensitivity/specificity and significance level, for the estimation of the accuracy of a single diagnostic test.


```{r examples-power_calc}

 power_calc(alpha=0.05, margin=0.05, sen_spe=0.8, sample_size=502) 
# Power of the study. Using the same parameters as sample_size_calculation. Should be ~80%

```

### Sample Size Population Proportion 

Calculate the sample size necessary to estimate a proportion in a finite or infinite proportion. (Daniel et. al)



```{r examples-sample_size_pop_prop}

 n_pop_prop(alpha = 0.05, p =  0.5, margin = 0.1, N = 1000) 

# sample size for a population of 1000 people to estimate that at least half of the population has the desired characteristic with an error margin of 10%

 n_pop_prop(alpha = 0.05, p =  0.5, margin = 0.1) 
 # same calculation in an infinite population
```

### cluster_random_sample_size

Calculates the number of clusters necessary for a cluster randomized trials. 
    

  

```{r example-cluster_random_sample_size}

# The matched trial protocol required 80% power of detecting a 50% reduction of annual HIV incidence from an assumed 1% in the control arm (π0 = 0.02 over 2 years) to 0.5% in the intervention arm (π1 = 0.01). Thus, with m = 1000 adults followed up in each cluster, the number of clusters required per treatment arm in a matched design was gives 6.8 = 7 cluster pairs
cluster_random_sample_size(alpha=0.05, power=0.8, coef_var=0.25, A =2, pi=0.01, pc=0.02, CS=1000)
```

  

  



